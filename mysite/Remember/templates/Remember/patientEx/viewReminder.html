{% load static %} 
<link rel="stylesheet" type="text/css" href="{% static 'remember/style.css' %}"> 

<!doctype html>
<html lang="en">
    <head>
        <title>View Reminder</title>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
         
        <style>

            body{
                font-family: 'Sans serif', Helvetica, sans-serif;
            }
            
            .navbar{
                border-bottom: 3px solid black;
                background: rgba(255, 255, 255, 0.9);
            }

            .autohide{
                position: fixed;
                top: 0;
                right: 0;
                left: 0;
                width: 100%;
                z-index: 1030;
            }
            .scrolled-down{
                transform:translateY(-100%); transition: all 0.3s ease-in-out;
            }

            .scrolled-up{
                transform:translateY(0); transition: all 0.3s ease-in-out;
            }

            .backButton{
                width:51px;height:51px;
                background: transparent url(/../../static/remember/images/backButton.png) no-repeat;
                background-color: transparent;
                mix-blend-mode: multiply;
                background-size: cover;
                border: none;
            }

            .logo{
                width:83.1px; height: 72px; 
                /* Original size width: 374; height: 324 */
                background: transparent url(/../../static/remember/images/RememberLogoSized.png) no-repeat;
                mix-blend-mode: multiply;
                background-size: cover;
                border: none;
                
            }

            .btn.btn-secondary.dropdown-toggle {
                background-color: rgb(211,211,211);  
            }

            .heading-section{
                color: white;
                font-size: calc(2.0vw + 2.5vh);
            }
               
            a {
                transition: .3s all ease;
                color: #1089ff; 
            }

            a:hover, a:focus {
                text-decoration: none !important;
                outline: none !important;
                box-shadow: none; 
            }

            h1, h2, h3, h4, h5,
            .h1, .h2, .h3, .h4, .h5 {
            line-height: 1.5;
            font-weight: 400;
            font-family: 'Sans serif', Helvetica, sans-serif;
            color: #000; }

            .bg-primary {
            background: #1089ff !important; }

            .calendar {
            margin: auto;
            font-weight: 400;
            height:auto;
            }

            .calendar_content {
            background: #fff; }

            .calendar_weekdays {
            background: #1089ff;
            }

            .calendar_header {
            padding: 10px 0; }

            .calendar_content, .calendar_weekdays, .calendar_header {
            position: relative;
            overflow: hidden; }

            .calendar_weekdays div {
            display: inline-block;
            vertical-align: top;
            color: #fff !important; }

            .calendar_weekdays div, .calendar_content div {
            width: 14.28571%;
            overflow: hidden;
            text-align: center;
            background-color: transparent;
            color: #000;
            font-size: 16px;
            padding: 15px 0; }

            .calendar_content div {
            border: 1px solid transparent;
            float: left;
            position: relative;
            z-index: 0; }

            .calendar_content div:hover {
            border: 1px solid #dcdcdc;
            cursor: default; }

            .calendar_content div.blank:hover {
            cursor: default;
            border: 1px solid transparent; }


            .calendar_content div.today {
            font-weight: bold;
            font-size: 16px;
            color: #fff !important; }
            
            .calendar_content div.today:after {
                position: absolute;
                top: 50%;
                left: 0;
                right: 0;
                bottom: 0;
                transform: translateY(-50%);
                content: '';
                width: 40px;
                height: 40px;
                border-radius: 50%;
                margin: 0 auto;
                background: #1089ff;
                z-index: -1;
                box-shadow: 0px 5px 11px -9px rgba(0, 0, 0, 0.48); }

            .calendar_content div.selected {
            background-color: #f0f0f0; }

            .calendar_header {
            width: 100%;
            text-align: center; }

            .calendar_header h2 {
            padding: 0 10px;
            font-weight: 500;
            font-size: 30px;
            color: #fff;
            float: left;
            width: 70%;
            margin: 0 0 10px; }

            button.switch-month {
            background-color: transparent;
            font-size: 25px;
            padding: 0;
            outline: none;
            border: none;
            color: #dcdcdc;
            float: left;
            width: 15%;
            transition: color .2s; }

            button.switch-month:hover {
            color: #1089ff; }  
            
            .event{
                background: white;
            }

            .results{
                border: 5px solid black;
                background-color: aliceblue;
                padding: 0.2%;
            }
        
        </style>
    </head>

    <body>
        <header>

        </header>

        <!-- All your html stuff here -->

        <nav class="autohide navbar navbar-light" style="padding-left: 1vw;padding-right: 1vw;">
            <a class="navbar-brand" href="#" >
                <button class="backButton" onclick="history.back()"></button>
            </a>
            <a href="">
                <div class="logo"></div>
            </a>
            <div class="dropdown" style="padding-right:1vw;">
                <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-bs-toggle="dropdown" aria-expanded="false">
                    <img src="/../../static/remember/images/settingsIcon1.png" style="width:42px;height:42px;">
                </a>
                <ul class="dropdown-menu dropdown-menu-lg-end" aria-labelledby="dropdownMenuLink">
                  <li><a class="dropdown-item" href="#">Logout</a></li>
                </ul>
            </div>
        </nav>   

        <section class="body-section mb-3 mt-4">
            <div class="container">
                <div class="row justify-content-start">
                    <div class="col-md-6 mb-2">
                        <h2 class="heading-section">Reminders</h2>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12 mb-3">
                        <div class="calendar calendar-first" id="calendar_first">
                        <div class="calendar_header">
                            <button class="switch-month switch-left"> <i class="fa fa-chevron-left"></i></button>
                            <h2></h2>
                            <button class="switch-month switch-right"> <i class="fa fa-chevron-right"></i></button>
                        </div>
                        <div class="calendar_weekdays"></div>
                        <div class="calendar_content"></div>
                        </div>
                    </div>
                </div>

                <div class="justify-content-start">
                    <div class="col-md-12 mb-3 p-2 event">
                        <h2 class="">Events</h2>
                        <div class="container results">
                            <div class="row flex-nowrap">
                                <div class="col-7">
                                    <div class="d-flex justify-content-start">
                                        <h5>
                                            Take Medicine 
                                        </h5>
                                    </div>
                                    <div class="d-flex justify-content-start">
                                        <p class="boxContent">
                                            Time:
                                            <span class="time"></span>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                
            </div>
        </section>

        <script>
            document.addEventListener("DOMContentLoaded", function(){

                el_autohide = document.querySelector('.autohide');
                // add padding-top to bady (if necessary)
                navbar_height = document.querySelector('.navbar').offsetHeight;
                document.body.style.paddingTop = navbar_height + 'px';

                if(el_autohide){
                var last_scroll_top = 0;
                window.addEventListener('scroll', function() {
                        let scroll_top = window.scrollY;
                    if(scroll_top < last_scroll_top) {
                            el_autohide.classList.remove('scrolled-down');
                            el_autohide.classList.add('scrolled-up');
                        }
                    else {
                        el_autohide.classList.remove('scrolled-up');
                        el_autohide.classList.add('scrolled-down');
                    }
                        last_scroll_top = scroll_top;
                }); 
                // window.addEventListener
                }
                // if

            }); 
        </script>
        
        <!-- Optional JavaScript -->
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
        <script>
            //add animation to nav bar
            document.addEventListener("DOMContentLoaded", function(){

            el_autohide = document.querySelector('.autohide');
            // add padding-top to bady (if necessary)
            navbar_height = document.querySelector('.navbar').offsetHeight;
            document.body.style.paddingTop = navbar_height + 'px';

            if(el_autohide){
            var last_scroll_top = 0;
            window.addEventListener('scroll', function() {
                    let scroll_top = window.scrollY;
                if(scroll_top < last_scroll_top) {
                        el_autohide.classList.remove('scrolled-down');
                        el_autohide.classList.add('scrolled-up');
                    }
                else {
                    el_autohide.classList.remove('scrolled-up');
                    el_autohide.classList.add('scrolled-down');
                }
                    last_scroll_top = scroll_top;
            }); 
            // window.addEventListener
            }
            // if

            });

            //end of adding animation to nav bar


            //calendar functionality
            (function($) {

                "use strict";


                $(document).ready(function () {
                function c(passed_month, passed_year, calNum) {
                    var calendar = calNum == 0 ? calendars.cal1 : calendars.cal2;
                    makeWeek(calendar.weekline);
                    calendar.datesBody.empty();
                    var calMonthArray = makeMonthArray(passed_month, passed_year);
                    var r = 0;
                    var u = false;
                    while (!u) {
                        if (daysArray[r] == calMonthArray[0].weekday) {
                            u = true
                        } else {
                            calendar.datesBody.append('<div class="blank"></div>');
                            r++;
                        }
                    }
                    for (var cell = 0; cell < 42 - r; cell++) { // 42 date-cells in calendar
                        if (cell >= calMonthArray.length) {
                            calendar.datesBody.append('<div class="blank"></div>');
                        } else {
                            var shownDate = calMonthArray[cell].day;
                            var iter_date = new Date(passed_year, passed_month, shownDate);
                            if (
                            (
                            (shownDate != today.getDate() && passed_month == today.getMonth()) || passed_month != today.getMonth()) && iter_date < today) {
                                var m = '<div class="past-date">';
                            } else {
                                var m = checkToday(iter_date) ? '<div class="today">' : "<div>";
                            }
                            calendar.datesBody.append(m + shownDate + "</div>");
                        }
                    }

                    var color = "#444444";
                    calendar.calHeader.find("h2").text(i[passed_month] + " " + passed_year);
                    calendar.weekline.find("div").css("color", color);
                    calendar.datesBody.find(".today").css("color", "#00bdaa");

                    // find elements (dates) to be clicked on each time
                    // the calendar is generated
                    var clicked = false;
                    selectDate(selected);

                    clickedElement = calendar.datesBody.find('div');
                    clickedElement.on("click", function () {
                        clicked = $(this);
                        var whichCalendar = calendar.name;

                        if (Click) {
                        click = true;
                        Clicked = getClickedInfo(clicked, calendar);
                        selected[Clicked.year] = {};
                        selected[Clicked.year][Clicked.month] = [Clicked.date];
                        var timer = document.getElementsByClassName("time");
                        var today = new Date();
                        var time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
                        timer.appendChild(time);

                        } else { // reset clicks
                                selected = {};
                                Clicked = [];
                                Click = false;
                                bothCals.find(".calendar_content").find("div").each(function () {
                                    $(this).removeClass("selected");
                                });
                            }
                        selectDate(selected);

                    });

                }

                function selectDate(selected) {
                    if (!$.isEmptyObject(selected)) {
                        var dateElements1 = datesBody1.find('div');

                        function highlightDate(passed_year, passed_month, dateElements) {
                            if (passed_year in selected && passed_month in selected[passed_year]) {
                                var daysToCompare = selected[passed_year][passed_month];
                                for (var d in daysToCompare) {
                                    dateElements.each(function (index) {
                                        if (parseInt($(this).text()) == daysToCompare[d]) {
                                            $(this).addClass('selected');
                                        }
                                    });
                                }

                            }
                        }

                        highlightDate(year, month, dateElements1);
                    }
                }

                

                function makeMonthArray(passed_month, passed_year) { // creates Array specifying dates and weekdays
                    var e = [];
                    for (var r = 1; r < getDaysInMonth(passed_year, passed_month) + 1; r++) {
                        e.push({
                            day: r,
                            // Later refactor -- weekday needed only for first week
                            weekday: daysArray[getWeekdayNum(passed_year, passed_month, r)]
                        });
                    }
                    return e;
                }


                function makeWeek(week) {
                    week.empty();
                    for (var e = 0; e < 7; e++) {
                        week.append("<div>" + daysArray[e].substring(0, 3) + "</div>")
                    }
                }

                function getDaysInMonth(currentYear, currentMon) {
                    return (new Date(currentYear, currentMon + 1, 0)).getDate();
                }

                function getWeekdayNum(e, t, n) {
                    return (new Date(e, t, n)).getDay();
                }

                function checkToday(e) {
                    var todayDate = today.getFullYear() + '/' + (today.getMonth() + 1) + '/' + today.getDate();
                    var checkingDate = e.getFullYear() + '/' + (e.getMonth() + 1) + '/' + e.getDate();
                    return todayDate == checkingDate;

                }

                function getAdjacentMonth(curr_month, curr_year, direction) {
                    var theNextMonth;
                    var theNextYear;
                    if (direction == "next") {
                        theNextMonth = (curr_month + 1) % 12;
                        theNextYear = (curr_month == 11) ? curr_year + 1 : curr_year;
                    } else {
                        theNextMonth = (curr_month == 0) ? 11 : curr_month - 1;
                        theNextYear = (curr_month == 0) ? curr_year - 1 : curr_year;
                    }
                    return [theNextMonth, theNextYear];
                }

                function b() {
                    today = new Date;
                    year = today.getFullYear();
                    month = today.getMonth();
                    var nextDates = getAdjacentMonth(month, year, "next");
                    nextMonth = nextDates[0];
                    nextYear = nextDates[1];
                }

                var e = 480;

                var today;
                var year,
                month,
                nextMonth,
                nextYear;

                var r = [];
                var i = [
                    "January",
                    "Feburary",
                    "March",
                    "April",
                    "May",
                    "June",
                    "July",
                    "August",
                    "September",
                    "October",
                    "November",
                    "December"];
                var daysArray = [
                    "Sunday",
                    "Monday",
                    "Tuesday",
                    "Wednesday",
                    "Thursday",
                    "Friday",
                    "Saturday"];

                var cal1 = $("#calendar_first");
                var calHeader1 = cal1.find(".calendar_header");
                var weekline1 = cal1.find(".calendar_weekdays");
                var datesBody1 = cal1.find(".calendar_content");

                var cal2 = $("#calendar_second");
                var calHeader2 = cal2.find(".calendar_header");
                var weekline2 = cal2.find(".calendar_weekdays");
                var datesBody2 = cal2.find(".calendar_content");

                var bothCals = $(".calendar");

                var switchButton = bothCals.find(".calendar_header").find('.switch-month');

                var calendars = {
                    "cal1": {
                        "name": "first",
                            "calHeader": calHeader1,
                            "weekline": weekline1,
                            "datesBody": datesBody1
                    },
                        "cal2": {
                        "name": "second",
                            "calHeader": calHeader2,
                            "weekline": weekline2,
                            "datesBody": datesBody2
                    }
                }

                var clickedElement;
                var Clicked;
                var click = false;
                var selected = {};

                b();
                c(month, year, 0);
                c(nextMonth, nextYear, 1);
                switchButton.on("click", function () {
                    var clicked = $(this);
                    var generateCalendars = function (e) {
                        var nextDatesFirst = getAdjacentMonth(month, year, e);
                        var nextDatesSecond = getAdjacentMonth(nextMonth, nextYear, e);
                        month = nextDatesFirst[0];
                        year = nextDatesFirst[1];
                        nextMonth = nextDatesSecond[0];
                        nextYear = nextDatesSecond[1];

                        c(month, year, 0);
                        c(nextMonth, nextYear, 1);
                    };
                    if (clicked.attr("class").indexOf("left") != -1) {
                        generateCalendars("previous");
                    } else {
                        generateCalendars("next");
                    }
                    clickedElement = bothCals.find(".calendar_content").find("div");
                });

                 //  Click picking stuff
                 function getClickedInfo(element, calendar) {
                    var clickedInfo = {};
                    var clickedCalendar,
                    clickedMonth,
                    clickedYear;
                    clickedCalendar = calendar.name;
                    clickedMonth = clickedCalendar == "first" ? month : nextMonth;
                    clickedYear = clickedCalendar == "first" ? year : nextYear;
                    clickedInfo = {
                        "calNum": clickedCalendar,
                            "date": parseInt(element.text()),
                            "month": clickedMonth,
                            "year": clickedYear
                    }
                    return clickedInfo;
                }


                });


            })(jQuery);

        </script>

    </body>
</html>